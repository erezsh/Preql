table Country:
    name: Str
    language: Str

table Person:
    name: Str
    country: Country -> citizens
    

add Country("Israel", "he") as isr
add Country("England", "en") as eng
add Country("United States", "en") as us

add Person("Erez Shinan", isr) as me
add Person("Ephraim Kishon", isr)
add Person("Eric Blaire", eng)
add Person("H.G. Wells", eng)
add Person("John Steinbeck", us)


english_speakers = Person[country.language="en"]
person_and_language = Person {name, country.language}
others_from_my_country = Person [country=me.country, id!=me.id]

population_count = Person {country.name => count(id)}

population_count2 = Country {name => count(citizens)}

# citizens_list = Country {name => citizens.name}     # array_agg



# explicit_join = (
#     join(c = Country[language="en"], p = Person)
#     { p.id, p.name, c.name }
# )

# explicit_join2 = (
#    freejoin(c = Country, p = Person)
#    [c.language="en", p.country = c]
#    { p.id, p.name, c.name }
# )
